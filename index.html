<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0, viewport-fit=cover">
    <title>OSRS Tracker V49</title>
    <style>
        @import url('https://fonts.cdnfonts.com/css/runescape-uf');
        :root { --osrs-orange: #ff981f; --osrs-yellow: #ffff00; --bg: #1a1712; }
        
        /* iPhone Air Safari Reset */
        html, body { 
            margin: 0; padding: 0; width: 100%; height: 100dvh;
            background: #000; overflow: hidden; touch-action: manipulation;
            font-family: 'RuneScape UF', sans-serif;
        }

        .container {
            display: flex; flex-direction: column;
            height: 100%; max-width: 500px; margin: 0 auto;
            background: var(--bg);
        }

        /* Top-Loaded Navigation to avoid Safari Bottom Bar */
        .nav {
            display: grid; grid-template-columns: repeat(3, 1fr);
            height: 60px; border-bottom: 2px solid var(--osrs-orange);
            background: #000; z-index: 100;
        }
        .tab {
            background: #3e3529; color: #fff; border: 1px solid #111;
            font-size: 18px; cursor: pointer; font-family: 'RuneScape UF';
        }
        .tab.active { background: var(--osrs-orange); color: #000; }

        .input-box {
            display: flex; padding: 10px; gap: 8px; background: #222;
            border-bottom: 1px solid #444;
        }
        input { flex: 1; padding: 12px; background: #000; color: #0f0; border: 1px solid #555; font-size: 16px; border-radius: 4px; }
        .btn { background: #006400; color: #fff; border: none; padding: 0 15px; border-radius: 4px; font-family: 'RuneScape UF'; }

        .view { flex: 1; overflow-y: auto; padding: 15px; -webkit-overflow-scrolling: touch; }
        .pane { display: none; }
        .pane.active { display: block; }

        .inv { 
            display: grid; grid-template-columns: repeat(4, 1fr); gap: 8px; 
            background: #4e4435; padding: 10px; border: 3px solid #3e3529; 
            width: 260px; margin: 0 auto;
        }
        .slot { aspect-ratio: 1; background: rgba(0,0,0,0.5); border: 1px solid #3e3529; display: flex; align-items: center; justify-content: center; }
        .item { width: 85%; height: 85%; object-fit: contain; }

        .log { background: #726451; padding: 8px; font-size: 15px; border: 2px solid #3e3529; margin-top: 15px; min-height: 60px; color: #fff; }
    </style>
</head>
<body>

<div class="container">
    <div class="nav">
        <button class="tab active" onclick="setTab('c', this)">COMBAT</button>
        <button class="tab" onclick="setTab('s', this)">SHOP</button>
        <button class="tab" onclick="setTab('x', this)">STATS</button>
    </div>

    <div class="input-box">
        <input type="number" id="v" placeholder="Deposit $">
        <button class="btn" onclick="add()">ADD</button>
    </div>

    <div class="view">
        <div id="p-c" class="pane active">
            <div class="inv" id="g"></div>
            <div class="log" id="l">System: V49 Air-Safe Ready.</div>
        </div>

        <div id="p-s" class="pane" style="color:var(--osrs-yellow); text-align:center;">
            Rewards Auto-Unlock!<br><br>
            Next Armor: $<span id="next-a">20</span><br>
            Next Weapon: $25
        </div>

        <div id="p-x" class="pane">
            <div style="background:#222; padding:15px; border:1px solid var(--osrs-orange);">
                <p>Arm Unlocks: <span id="c-a">0</span></p>
                <p>Wep Unlocks: <span id="c-w">0</span></p>
                <button onclick="localStorage.clear();location.reload();" style="color:red; background:none; border:1px solid red; width:100%; padding:8px;">RESET</button>
            </div>
        </div>
    </div>
</div>

<script>
    let d = { a:0, w:0, ai:0, wi:0, i:[] };
    const AR = [
        { n: 'Rune Helm', u: 'https://oldschool.runescape.wiki/images/Rune_full_helm.png' },
        { n: 'Rune Platebody', u: 'https://oldschool.runescape.wiki/images/Rune_platebody.png' },
        { n: 'Rune Kiteshield', u: 'https://oldschool.runescape.wiki/images/Rune_kiteshield.png' },
        { n: 'Rune Platelegs', u: 'https://oldschool.runescape.wiki/images/Rune_platelegs.png' }
    ];
    const WP = [
        { n: 'Rune Scimitar', u: 'https://oldschool.runescape.wiki/images/Rune_scimitar.png' },
        { n: 'Dragon Scimitar', u: 'https://oldschool.runescape.wiki/images/Dragon_scimitar.png' }
    ];

    function getA() { return d.ai < 4 ? 20 : d.ai < 8 ? 40 : 70; }

    function add() {
        let val = parseInt(document.getElementById('v').value) || 0;
        if (val <= 0) return;
        d.a += val; d.w += val;

        let cost = getA();
        while (d.ai < AR.length && d.a >= cost) {
            d.i.push(AR[d.ai]);
            msg("Got: " + AR[d.ai].n, "yellow");
            d.a -= cost; d.ai++; cost = getA();
        }
        while (d.wi < WP.length && d.w >= 25) {
            d.i.push(WP[d.wi]);
            msg("Got: " + WP[d.wi].n, "#0f0");
            d.w -= 25; d.wi++;
        }
        document.getElementById('v').value = '';
        save(); draw();
    }

    function draw() {
        document.getElementById('c-a').innerText = d.ai;
        document.getElementById('c-w').innerText = d.wi;
        document.getElementById('next-a').innerText = getA();
        const g = document.getElementById('g'); g.innerHTML = '';
        for(let j=0; j<28; j++) {
            const s = document.createElement('div'); s.className = 'slot';
            if(d.i[j]) s.innerHTML = `<img src="${d.i[j].u}" class="item">`;
            g.appendChild(s);
        }
    }

    function setTab(p, b) {
        document.querySelectorAll('.pane').forEach(x => x.classList.remove('active'));
        document.querySelectorAll('.tab').forEach(x => x.classList.remove('active'));
        document.getElementById('p-'+p).classList.add('active');
        b.classList.add('active');
    }

    function msg(m, c) { const l = document.getElementById('l'); l.innerHTML += `<div style="color:${c}">> ${m}</div>`; l.scrollTop = l.scrollHeight; }
    function save() { localStorage.setItem('OSRS_V49', JSON.stringify(d)); }
    function load() { const saved = localStorage.getItem('OSRS_V49'); if(saved) d = JSON.parse(saved); }

    load(); draw();
</script>
</body>
</html>
