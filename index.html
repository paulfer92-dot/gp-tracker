<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0, viewport-fit=cover">
    <title>OSRS V47 - Air Fix</title>
    <style>
        @import url('https://fonts.cdnfonts.com/css/runescape-uf');
        :root { --osrs-orange: #ff981f; --osrs-yellow: #ffff00; --bg-inv: #4e4435; }
        
        html, body { 
            margin: 0; padding: 0; width: 100%; height: 100dvh;
            background: #000; overflow: hidden; 
            font-family: 'RuneScape UF', sans-serif;
        }

        .app-shell {
            height: 100%; display: flex; flex-direction: column;
            max-width: 500px; margin: 0 auto; background: #1a1712;
        }

        /* 1. TOP NAVIGATION (SAFE ZONE) */
        .nav-header {
            display: grid; grid-template-columns: repeat(3, 1fr);
            height: 65px; background: #000; border-bottom: 3px solid var(--osrs-orange);
            z-index: 100;
        }
        .nav-btn {
            background: #3e3529; color: #fff; border: 1px solid #111;
            font-family: 'RuneScape UF'; font-size: 20px; cursor: pointer;
        }
        .nav-btn.active { background: var(--osrs-orange); color: #000; font-weight: bold; }

        /* 2. TOP INPUT (SAFE ZONE) */
        .input-area {
            background: #222; padding: 12px; border-bottom: 2px solid #444;
            display: flex; gap: 10px; z-index: 90;
        }
        input { flex: 1; padding: 15px; background: #000; color: #0f0; border: 1px solid #666; font-size: 18px; border-radius: 5px; }
        .add-btn { background: #006400; color: white; padding: 0 20px; border-radius: 5px; cursor: pointer; border: none; font-family: 'RuneScape UF'; font-size: 18px; }

        .header-stats { display: flex; justify-content: space-around; padding: 10px; background: #2a241c; color: var(--osrs-yellow); font-size: 18px; }

        /* 3. SCROLLABLE CONTENT AREA */
        .main-view { flex: 1; overflow-y: auto; padding: 10px; padding-bottom: 120px; /* Space for Safari bottom bar */ }
        .pane { display: none; }
        .pane.active { display: block; }

        .inv-grid { 
            display: grid; grid-template-columns: repeat(4, 1fr); gap: 8px; 
            background: var(--bg-inv); padding: 10px; border: 4px solid #3e3529; 
            width: 280px; margin: 0 auto;
        }
        .slot { aspect-ratio: 1; background: rgba(0,0,0,0.6); border: 1px solid #3e3529; display: flex; justify-content: center; align-items: center; }
        .item-icon { width: 85%; height: 85%; object-fit: contain; }

        .chatbox { background: #726451; padding: 10px; font-size: 16px; border: 2px solid #3e3529; margin-top: 15px; min-height: 80px; }
    </style>
</head>
<body>

<div class="app-shell">
    <div class="nav-header">
        <button class="nav-btn active" id="b-combat" onclick="setTab('combat')">COMBAT</button>
        <button class="nav-btn" id="b-shop" onclick="setTab('shop')">SHOP</button>
        <button class="nav-btn" id="b-stats" onclick="setTab('stats')">STATS</button>
    </div>

    <div class="input-area">
        <input type="number" id="cash-in" placeholder="Deposit cash...">
        <button class="add-btn" onclick="deposit()">ADD</button>
    </div>

    <div class="header-stats">
        <div>$ Arm: <span id="arm-bank">0</span></div>
        <div>$ Wep: <span id="wep-bank">0</span></div>
    </div>

    <div class="main-view">
        <div id="p-combat" class="pane active">
            <div class="inv-grid" id="main-inv"></div>
            <div class="chatbox" id="chat">V47: Air Fix. All buttons moved to the Top Safe Zone.</div>
        </div>

        <div id="p-shop" class="pane">
            <div style="color:var(--osrs-yellow); text-align:center; padding:20px;">
                Rewards unlock automatically as you deposit!<br><br>
                Armor: $20 / $40 / $70<br>
                Weapons: $25 (Every tier)
            </div>
        </div>

        <div id="p-stats" class="pane">
            <div style="background:#222; padding:20px; border:1px solid var(--osrs-orange); border-radius:10px;">
                <p>Armor Unlocks: <span id="s-arm-count">0</span> (Next: $<span id="s-arm-cost">20</span>)</p>
                <p>Weapon Unlocks: <span id="s-wep-count">0</span> (Next: $25)</p>
                <button onclick="wipeData()" style="color:red; background:none; border:1px solid red; width:100%; padding:10px; margin-top:20px;">FULL WIPE</button>
            </div>
        </div>
    </div>
</div>

<script>
    const KEY = 'OSRS_V47_AIR';
    let s = { arm:0,
